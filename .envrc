# RacketCon 2025 direnv configuration
# Automatically checks dependencies when entering the directory
# Install direnv: https://direnv.net/
#
# Enable with: direnv allow

# Check for essential tools
if ! has racket; then
    echo "‚ö†Ô∏è  Racket not found. Install with: sudo pkg install racket-minimal"
fi

if ! has raco; then
    echo "‚ö†Ô∏è  raco not found"
fi

if ! has emacs; then
    echo "‚ö†Ô∏è  Emacs not found. Install with: sudo pkg install emacs"
else
    # Check Emacs version
    EMACS_VERSION=$(emacs --version 2>/dev/null | head -1 | grep -oE '[0-9]+' | head -1)
    if [ "$EMACS_VERSION" -lt 30 ]; then
        echo "‚ö†Ô∏è  Emacs 30+ required (found: $EMACS_VERSION)"
    fi
fi

# Add project bin to PATH if it exists
PATH_add bin

# Add local elisp directory to EMACSLOADPATH
export EMACSLOADPATH="$PWD/elisp:$EMACSLOADPATH"

# Set project root
export RACKETCON_PROJECT_ROOT="$PWD"

# Display welcome message
echo "üé™ RacketCon 2025 Environment"
echo "   Project: $PWD"
echo ""
echo "Quick start:"
echo "  make help        - Show all available targets"
echo "  make setup       - Check dependencies and download resources"
echo "  make test        - Run tests"
echo ""
